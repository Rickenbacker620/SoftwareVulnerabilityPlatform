<template lang="pug">
VChart.chart(:option="option" :autoresize="true")
</template>

<script setup>
import { use } from "echarts/core"
import { CanvasRenderer } from "echarts/renderers"
import { PieChart } from "echarts/charts"
import { statService } from "@/utils/services"
import {
    TooltipComponent,
    ToolboxComponent
} from "echarts/components"
import VChart from "vue-echarts"
import { ref } from "vue"
use([
    CanvasRenderer,
    PieChart,
    TooltipComponent,
    ToolboxComponent
])

const { data } = await statService.vulnleave()
const rank = data.map((e) => {
    return { value: e.count, name: e.cvss2_type ?? "NULL" }
})
const option = ref({
    tooltip: {
        trigger: "item",
        formatter: "{b}: <br/>  {c} ({d}%)",
    },
    toolbox: {
        show: false,
    },
    series: [
        {
            name: "危险等级",
            type: "pie",
            radius: "50%",
            data: rank,
        },
    ],
})
</script>
