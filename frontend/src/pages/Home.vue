<template lang="pug">
NLayout(style="top: 64px;" position="absolute" has-sider)
    NLayoutSider(collapse-mode="width" show-trigger="bar" :collapsed-width="64" :width="150")
        NMenu(:options="menuOptions"
            :render-label="renderMenuLabel"
            :collapsed-width="64"
            :collapsed-icon-size="24")
    NLayoutContent(:native-scrollbar="false")
        div.overflow-auto.mx-10.my-10
            router-view
</template>

<script setup lang="ts">
import { datasetService } from "@/utils/services"
import { h, onMounted } from "vue"
import { NButton } from "naive-ui"
import { RouterLink, useRoute, useRouter } from "vue-router"
import { ChartBar, Task, WordCloud } from "@vicons/carbon"
import { useUserStore } from "@/stores/user"
import { renderIcon } from "@/utils/others"

function renderMenuLabel(option) {
    return h(RouterLink, { to: option.to }, { default: () => option.label })
}

const menuOptionsAdmin = [
    {
        to: {
            name: "DatasetList",
        },
        label: "数据集",
        key: "dataset",
        icon: renderIcon(WordCloud),
    },
    {
        to: {
            name: "TaskList",
        },
        label: "任务",
        key: "task",
        icon: renderIcon(Task),
    },
    {
        to: {
            name: "TaskAssign",
        },
        label: "分配任务",
        key: "assign",
        icon: renderIcon(Task),
    },
]

let menuOptions = [
    {
        to: {
            name: "TaskList",
        },
        label: "任务",
        key: "task",
        icon: renderIcon(Task),
    },
]

const userStore = useUserStore()
if (userStore.role === ("admin" || "approver")) {
    menuOptions = menuOptionsAdmin
}
</script>
