<!-- <template lang="pug">
//- div(id="vulcount" style="height:400px;")
div.grid.grid-cols-3.grid-rows-2.place-content-stretch.mt-10(class="h-2/3")
    div(id="vulnleave" style="height:400px;")
    div(id="vulcount" style="height:400px;")
    //- div(id="vulnleave" style="width: 400px;height:400px;")
    //- div(id="vulcount" style="width: 400px;height:400px;")
</template>

<script setup lang="ts">
import * as echarts from "echarts"
import { onMounted } from "vue"
import { statService } from "@/utils/services"

async function chart1() {
    const vulnLeave = echarts.init(document.getElementById("vulnleave"))
    const { data } = await statService.vulnleave()
    const rank = data.map((e) => {
        return { value: e.count, name: e.cvss2_type ?? "NULL" }
    })
    const option = {
        tooltip: {
            trigger: "item",
            formatter: "{b}: <br/>  {c} ({d}%)",
        },
        toolbox: {
            show: false,
        },
        series: [
            {
                name: "危险等级",
                type: "pie",
                radius: "50%",
                data: rank,
            },
        ],
    }
    vulnLeave.setOption(option)
    window.addEventListener("resize", function () {
        vulnLeave.resize()
    })
}

async function chart2() {
    // 基于准备好的dom，初始化echarts实例
    var myChart = echarts.init(document.getElementById("vulcount"))
    const option = {
        tooltip: {
            trigger: "axis",
            axisPointer: { type: "shadow" },
        },
        legend: {
            top: "0%",
            left: "20%",
            data: ["缺陷总数", "未知缺陷"],
            itemGap: 5,
            itemWidth: 15,
        },
        xAxis: [
            {
                type: "category",
                boundaryGap: false,
                axisLabel: {
                    formatter: "{value}年",
                },
                data: [
                    1988, 1989, 1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997,
                    1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007,
                    2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017,
                    2018, 2019, 2020, 2021,
                ],
            },
        ],
            dataZoom: [
                {   // 这个dataZoom组件，默认控制x轴。
                    type: 'slider', // 这个 dataZoom 组件是 slider 型 dataZoom 组件
                    start: 70,      // 左边在 10% 的位置。
                    end: 100          // 右边在 60% 的位置。
                }
            ],
        yAxis: [
            {
                axisLabel: {
                    formatter: "{value}个",
                    align: "center"
                },
            },
        ],
        series: [
            {
                name: "缺陷总数",
                type: "bar",
                data: [
                    2, 3, 11, 15, 13, 13, 25, 25, 75, 253, 246, 894, 1020, 1677,
                    2161, 1534, 2453, 4937, 6624, 6658, 5847, 5761, 4645, 4142,
                    5291, 5195, 7961, 6549, 6721, 15199, 18062, 18823, 19502,
                    4794,
                ],
            },
            {
                name: "未知缺陷",
                type: "bar",
                data: [
                    2, 3, 11, 15, 13, 13, 25, 25, 73, 246, 239, 846, 998, 1631,
                    1926, 1277, 2290, 4563, 5740, 4090, 648, 826, 875, 775,
                    1132, 1056, 1104, 1294, 1127, 1685, 2020, 2196, 2137, 643,
                ],
            },
        ],
    }
    myChart.setOption(option)

    window.addEventListener("resize", function () {
        myChart.resize()
    })
}

onMounted(async () => {
    // await chart1()
    await chart2()
})
</script> -->

<template lang="pug">
//- div.flex.justify-center.items-center.w-96.h-96.bg-blue-200
//-     div.w-10.h-10.bg-red-400.inset-auto
//- div.grid.grid-cols-3.grid-rows-2.w-96.h-96.bg-yellow-500.place-items-center
//-     div.w-10.h-10.bg-red-400
//-     div.w-10.h-10.bg-red-400
//-     div.w-10.h-10.bg-red-400
//-     div.w-10.h-10.bg-red-400
//-     div.w-10.h-10.bg-red-400
//-     div.w-10.h-10.bg-red-400
div.grid.grid-cols-3.grid-rows-2.place-items-center.mt-10.gap-7(class="h-2/3")
    div.chartbox
        div 漏洞危险分类
        vleave
    div.chartbox
        div 漏洞统计
        vcount
    div.chartbox
        div 最新提交漏洞TOP5
        pubtop5.mt-48
    div.chartbox
        div 漏洞类型排行榜
        vdate
    div.chartbox
        div 高危漏洞统计
        cvsscount
    div.chartbox
        div 最新更新漏洞TOP5
        updatetop5
</template>

<script setup lang="ts">
import vdate from "@/components/charts/vulndate.vue"
import pubtop5 from "@/components/charts/pubtop5.vue"
import updatetop5 from "@/components/charts/updatetop5.vue"
import cvsscount from "@/components/charts/cvsscount.vue"
import vleave from "@/components/charts/vulnleave.vue"
import vcount from "@/components/charts/vulncount.vue"

</script>

<style>
.chartbox {
    width: 500px;
    @apply flex;
    @apply p-3;
    @apply space-y-6;
    @apply flex-col;
    @apply h-80;
    @apply items-center;
    @apply border-2
}

.chartbox>div {
    @apply text-3xl;
    @apply justify-self-start;
}
</style>