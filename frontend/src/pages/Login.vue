<template lang="pug">
div.container
    NForm.w-56.mx-auto.my-20(:model="model")
        NFormItem(label="用户名" size="large")
            NInput(placeholder="" v-model:value="model.username" )
        NFormItem(label="密码" size="large")
            NInput(type="password" placeholder="" v-model:value="model.password")
        NFormItem.flex.justify-center
            div.space-x-4
                NButton(@click="login") 登录
                NButton(@click="login") 前往注册
</template>

<script setup lang="ts">
import { reactive } from "@vue/reactivity"
import { useMessage } from "naive-ui"
import { useRouter } from "vue-router"
import { useUserStore } from "@/stores/user"

const model = reactive({
    username: "",
    password: "",
})

const message = useMessage()
const router = useRouter()
const user = useUserStore()

const login = async () => {
    try {
        await user.login(model.username, model.password)
        router.push("/")
    } catch (error) {
        message.error("登陆失败")
    }
}
</script>
