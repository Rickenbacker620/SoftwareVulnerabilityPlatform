import { defineStore } from "pinia"
import _ from "lodash-es"
import router from "@/router"

export const useDatasetsStore = defineStore("datasets", {
    state: () => ({
        readList: [],
        current: 0,
        prevLink: "",
    }),
    actions: {
        initialize(list, current) {
            this.readList = list
            this.current = this.readList.findIndex((e) => e === current)
        },
        next() {
            this.current = _.clamp(
                this.current + 1,
                0,
                this.readList.length - 1,
            )
            router.push({
                name: "DatasetDetail",
                params: { id: this.readList[this.current] },
            })
        },
        prev() {
            this.current = _.clamp(
                this.current - 1,
                0,
                this.readList.length - 1,
            )
            router.push({
                name: "DatasetDetail",
                params: { id: this.readList[this.current] },
            })
        },
        savePrevPage(link) {
            this.prevLink = link
        },
        toPrevPage() {
            if (this.prevLink === "") {
                this.prevLink = router.resolve({ name: "TaskList" }).fullPath
            }
            router.push({ path: this.prevLink })
        },
    },
    getters: {
        end: (state) => state.current === state.readList.length - 1,
        start: (state) => state.current === 0,
    },
})
