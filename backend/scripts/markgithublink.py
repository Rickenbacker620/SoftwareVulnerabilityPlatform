from pymongo import MongoClient
import csv


def get_database():
    CONNECTION_STRING = "mongodb://localhost"

    client = MongoClient(CONNECTION_STRING)

    return client["svp"]


if __name__ == "__main__":
    db = get_database()
    collection = db["datasets"]
    i = 0
    with open("./cvefixcode.csv", "r") as file:
        f_csv  = csv.reader(file)
        for row in f_csv:
            if i == 0:
                i += 1
                continue
            i += 1
            if collection.find_one({"_id": row[0]}) is None:
                print("no")
            # test  = collection.find_one_and_update({"_id": row[0]}, {"$set": {"has_github":True}})
    print(i)