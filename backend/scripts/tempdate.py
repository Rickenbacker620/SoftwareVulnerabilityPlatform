from base import *

# ds_all = dataset_collection.find()

# for raw_ds in ds_all:
#    ds = Dataset(raw_ds)


def fixdate(ds):
    rawpb = ds["published_date"]
    if not isinstance(rawpb, str):
        return
    parsedpb = datetime.strptime(rawpb, '%Y-%m-%d %H:%M:%S')
    rawmod = ds["last_modified"]
    parsedmod = datetime.strptime(rawmod, '%Y-%m-%d %H:%M:%S')
    dataset_collection.find_one_and_update({"_id": ds["_id"]}, {"$set": {"published_date": parsedpb, "last_modified": parsedmod}})


ds_all = dataset_collection.find()

for raw_ds in ds_all:
    fixdate(raw_ds)
