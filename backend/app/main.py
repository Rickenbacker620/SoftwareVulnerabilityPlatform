
import uvicorn
from app.api import api_router
from app.core.config import settings
from app.core.utils import simplify_operation_ids
from fastapi import FastAPI
from tortoise import Tortoise
from tortoise.contrib.fastapi import register_tortoise

Tortoise.init_models(["app.models"], "models")


app = FastAPI(
    title="Software Vulnerability PlatForm API",
)

app.include_router(api_router, prefix=settings.API_V1_STR)

simplify_operation_ids(app)

register_tortoise(
    app,
    db_url="postgres://postgres:lucifer@host.docker.internal:5432/svp2",
    modules={"models": ["app.models"]},
    generate_schemas=True,
    add_exception_handlers=True,
)


if __name__ == "__main__":
    uvicorn.run(app, host="0.0.0.0", port=8000)
