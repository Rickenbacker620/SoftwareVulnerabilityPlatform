from datetime import datetime
from typing import Optional

from .extra import ORMModel
from tortoise.contrib.pydantic import pydantic_model_creator

from app.models import Dataset, CVEInfo, User


class DatasetSchema(ORMModel):
    cve_id: str
    approved: Optional[bool]
    ambiguous: Optional[bool]
    annotated: Optional[bool]
    description: str
    last_modified: Optional[datetime]




class DatasetDetailSchema(ORMModel):
    CVEInfoSchema = pydantic_model_creator(CVEInfo, name="CVEInfoSchema")

    approved: Optional[bool]
    ambiguous: Optional[bool]
    cve: CVEInfoSchema


DatasetCreateSchema = pydantic_model_creator(Dataset)


class AnnotationTaskSchema(ORMModel):
    name: str
    dataset: DatasetSchema
    done: bool


class AnnotationTaskCreateSchema(ORMModel):
    name: str
    size: int
